{"Facture" {:global {
                      :rules    [{:name          "R1"
                                  :priority 0
                                         :resourceClass "Facture"
                                         :domain        "GFC"
                                         :operation     "lire"
                                         :conditions       [[= [Person $s role] "chef_de_service"] [= [Person $s service] [Person $r service]] [< [Facture $r montant] [Person $s seuil]]]
                                         :effect        "allow"
                                         :startDate     "inf"
                                         :endDate       "inf"}

    ;;                             {:name          "R2"
      ;;                                   :resourceClass "Facture"
        ;;                                 :domain        "GFC"
          ;;                               :operation     "lire"
            ;;                             :resource      [Facture ?f]
              ;;                           :subject       [Person ?subject (= role "directeur")]
                ;;                         :effect        "allow"
                  ;;                       :startDate     "inf"
                    ;;                     :endDate       "inf"}
                                 {:name "R3"
                                  :ressourceClass "Mouvement"
                                  :priority 0
                                  :effect "allow"
                                  :domain   "GRH"
                                  :roles ["gestionnaire RH"]
                                  :operations ["créer" ]
                                  :conditions  [[= [Person $s code] [Mouvement $r codegestion]]]
                                  }
                                 ]
                      :strategy :almost_one_allow_no_deny}
             }

 

 "Diplome" {:global {
                     :rules [
                             {:name "DIP1"
                              :resourceClass "Diplome"
                              :priority 0
                              :domain   "SVE"
                              :operation "lire"
                              :conditions    [[= [Person $s role] "professeur"]]
                              :effect     "allow"
                              :startDate  "inf"
                              :endDate    "inf"
                              }
                             ]
                     }}

 "Application" {:global {
                         :rules [
                                 {:name "APP1"
                                  :resourceClass "Application"
                                  :priority 0
                                  :domain   "GFC"
                                  :operation "executer"
                                  :conditions    [[= [Person $s role] "comptable"] [= [Application $r name] "gfc-compta"]]
                                  :effect     "allow"
                                  :startDate  "inf"
                                  :endDate    "inf"
                                  }
                                 ]
                         }}

 ;; =============================================================================
 ;; Règles pour les Contrats
 ;; =============================================================================
 "Contrat" {:global {
                     :rules [
                             ;; Règle CT1: Accès aux contrats selon le département
                             {:name "CT1"
                              :resourceClass "Contrat"
                              :priority 0
                              :domain "LEGAL"
                              :operation "lire"
                              :conditions [[= [Person $s department] [Contrat $r owner-department]]]
                              :effect "allow"
                              :startDate "inf"
                              :endDate "inf"}

                             ;; Règle CT2: DPO peut accéder aux contrats contenant des PII
                             {:name "CT2"
                              :resourceClass "Contrat"
                              :priority 1
                              :domain "LEGAL"
                              :operation "lire"
                              :conditions [[= [Person $s role] "DPO"] [= [Contrat $r contains-pii] true]]
                              :effect "allow"
                              :startDate "inf"
                              :endDate "inf"}

                             ;; Règle CT3: Legal counsel peut accéder à tous les contrats
                             {:name "CT3"
                              :resourceClass "Contrat"
                              :priority 2
                              :domain "LEGAL"
                              :operation "lire"
                              :conditions [[= [Person $s role] "legal-counsel"]]
                              :effect "allow"
                              :startDate "inf"
                              :endDate "inf"}
                             ]
                     :strategy :almost_one_allow_no_deny}}

 ;; =============================================================================
 ;; Règles pour les Engagements Juridiques
 ;; =============================================================================
 "EngagementJuridique" {:global {
                                 :rules [
                                         ;; Règle EJ1: Accès basé sur le niveau de clearance
                                         {:name "EJ1"
                                          :resourceClass "EngagementJuridique"
                                          :priority 0
                                          :domain "LEGAL"
                                          :operation "lire"
                                          :conditions [[>= [Person $s clearance-level] [EngagementJuridique $r required-clearance-level]]]
                                          :effect "allow"
                                          :startDate "inf"
                                          :endDate "inf"}

                                         ;; Règle EJ2: Département responsable peut toujours accéder
                                         {:name "EJ2"
                                          :resourceClass "EngagementJuridique"
                                          :priority 1
                                          :domain "LEGAL"
                                          :operation "lire"
                                          :conditions [[= [Person $s department] [EngagementJuridique $r responsible-department]]]
                                          :effect "allow"
                                          :startDate "inf"
                                          :endDate "inf"}

                                         ;; Règle EJ3: Legal counsel peut accéder à tous les engagements
                                         {:name "EJ3"
                                          :resourceClass "EngagementJuridique"
                                          :priority 2
                                          :domain "LEGAL"
                                          :operation "lire"
                                          :conditions [[= [Person $s role] "legal-counsel"]]
                                          :effect "allow"
                                          :startDate "inf"
                                          :endDate "inf"}
                                         ]
                                 :strategy :almost_one_allow_no_deny}}
 }